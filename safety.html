<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Safety Systems Dashboard - Dummy Data</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.0"></script>

<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  .checkboxes label { margin-right: 15px; }
  canvas { max-width: 100%; margin-top: 20px; }
  .data-box { margin-top: 20px; }
  .sensor-box { margin-bottom: 8px; }
</style>
</head>
<body>

<h2>Live Dashboard - Safety Systems (Dummy Data)</h2>

<div class="checkboxes" id="sensorCheckboxes">
  <label><input type="checkbox" value="sensor1" checked> Sensor 1</label>
  <label><input type="checkbox" value="sensor2" checked> Sensor 2</label>
  <label><input type="checkbox" value="sensor3" checked> Sensor 3</label>
  <label><input type="checkbox" value="sensor4" checked> Sensor 4</label>
  <label><input type="checkbox" value="sensor5" checked> Sensor 5</label>
  <label><input type="checkbox" value="sensor6" checked> Sensor 6</label>
</div>

<canvas id="combinedChart"></canvas>

<div class="data-box" id="dataValues"></div>

<script>
  const ctx = document.getElementById('combinedChart').getContext('2d');

  const colors = {
    sensor1: 'red',
    sensor2: 'blue',
    sensor3: 'green',
    sensor4: 'orange',
    sensor5: 'purple',
    sensor6: 'brown'
  };

  // Generate dummy timestamps (last 10 minutes, 1-minute intervals)
  function generateTimestamps() {
    const now = Date.now();
    const timestamps = [];
    for (let i = 9; i >= 0; i--) {
      timestamps.push(new Date(now - i * 60000)); // 1 minute interval
    }
    return timestamps;
  }

  // Generate dummy sensor data
  function generateDummyData() {
    const sensors = ['sensor1', 'sensor2', 'sensor3', 'sensor4', 'sensor5', 'sensor6'];
    const timestamps = generateTimestamps();

    const data = {};
    sensors.forEach(sensor => {
      data[sensor] = timestamps.map(ts => ({
        x: ts,
        temperature: 20 + Math.random() * 5,
        humidity: 40 + Math.random() * 20
      }));
    });
    return data;
  }

  const dummyData = generateDummyData();

  // Initialize Chart
  const combinedChart = new Chart(ctx, {
    type: 'line',
    data: {
      datasets: []
    },
    options: {
      responsive: true,
      plugins: {
        zoom: { zoom: { wheel: { enabled: true }, mode: 'x' }, pan: { enabled: true, mode: 'x' } },
        tooltip: {
          callbacks: {
            label: ctx => {
              return ctx.dataset.label + ': ' + ctx.parsed.y.toFixed(2) + (ctx.dataset.temp ? ' °C' : ' %');
            }
          }
        }
      },
      scales: {
        x: {
          type: 'time',
          time: { tooltipFormat: 'HH:mm:ss', unit: 'minute' },
          title: { display: true, text: 'Time' }
        },
        y: {
          title: { display: true, text: 'Value' },
          min: 0,
          max: 100
        }
      }
    }
  });

  function updateChart(data) {
    const selectedSensors = Array.from(document.querySelectorAll('#sensorCheckboxes input:checked')).map(cb => cb.value);

    const tempDatasets = [];
    const humDatasets = [];

    selectedSensors.forEach(sensor => {
      const points = data[sensor];
      if (!points) return;

      tempDatasets.push({
        label: sensor + ' Temp',
        data: points.map(p => ({ x: p.x, y: p.temperature })),
        borderColor: colors[sensor],
        backgroundColor: colors[sensor],
        fill: false,
        temp: true,
        tension: 0.2
      });

      humDatasets.push({
        label: sensor + ' Hum',
        data: points.map(p => ({ x: p.x, y: p.humidity })),
        borderColor: colors[sensor],
        backgroundColor: colors[sensor],
        fill: false,
        borderDash: [5, 5],
        temp: false,
        tension: 0.2
      });
    });

    combinedChart.data.datasets = [...tempDatasets, ...humDatasets];
    combinedChart.update();

    // Update serial monitor
    const dataBox = document.getElementById('dataValues');
    dataBox.innerHTML = selectedSensors.map(sensor => {
      const last = data[sensor][data[sensor].length - 1];
      return `<div class="sensor-box">${sensor.toUpperCase()} - Temp: ${last.temperature.toFixed(2)}°C, Hum: ${last.humidity.toFixed(2)}%</div>`;
    }).join('');
  }

  document.getElementById('sensorCheckboxes').addEventListener('change', () => updateChart(dummyData));

  // Initial chart render
  updateChart(dummyData);
</script>

</body>
</html>
